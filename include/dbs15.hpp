#include <array>
#include <cstdint>
#include <endian.h>
#include <immintrin.h>
#include <sdsl/int_vector.hpp>

#include "internal.hpp"

namespace h0 {
namespace internal {

class wdbs {
    static const constexpr std::array<uint8_t, 4100> data = {
        0u, 2u, 0u, 12u, 0u, 40u, 0u, 144u, 2u, 32u, 8u, 64u, 
        32u, 128u, 129u, 0u, 7u, 0u, 26u, 0u, 100u, 1u, 136u, 6u, 
        16u, 24u, 32u, 80u, 64u, 80u, 129u, 33u, 4u, 66u, 16u, 10u, 
        32u, 36u, 64u, 136u, 130u, 17u, 0u, 82u, 1u, 36u, 4u, 72u, 
        16u, 144u, 65u, 32u, 5u, 64u, 18u, 128u, 69u, 1u, 10u, 4u, 
        20u, 0u, 88u, 1u, 48u, 4u, 96u, 16u, 192u, 65u, 129u, 3u, 
        
        0u, 15u, 0u, 58u, 0u, 228u, 3u, 136u, 14u, 16u, 56u, 32u, 
        104u, 65u, 144u, 130u, 161u, 2u, 194u, 9u, 132u, 6u, 136u, 25u, 
        16u, 98u, 33u, 68u, 65u, 72u, 132u, 145u, 2u, 162u, 9u, 68u, 
        34u, 136u, 11u, 16u, 38u, 32u, 140u, 66u, 24u, 128u, 105u, 1u, 
        146u, 6u, 36u, 24u, 72u, 40u, 144u, 145u, 34u, 34u, 64u, 164u, 
        130u, 73u, 8u, 146u, 2u, 164u, 9u, 72u, 34u, 144u, 133u, 32u, 
        22u, 64u, 76u, 129u, 25u, 4u, 50u, 0u, 212u, 3u, 40u, 12u, 
        80u, 48u, 160u, 161u, 66u, 66u, 129u, 69u, 4u, 138u, 17u, 20u, 
        5u, 40u, 18u, 80u, 68u, 161u, 9u, 64u, 42u, 128u, 149u, 2u, 
        42u, 8u, 84u, 1u, 104u, 4u, 208u, 17u, 160u, 67u, 65u, 6u, 
        128u, 27u, 0u, 102u, 1u, 140u, 6u, 24u, 24u, 48u, 80u, 96u, 
        80u, 193u, 33u, 132u, 67u, 1u, 70u, 4u, 140u, 17u, 24u, 66u, 
        48u, 10u, 96u, 36u, 192u, 137u, 130u, 19u, 0u, 86u, 1u, 44u, 
        4u, 88u, 16u, 176u, 65u, 96u, 5u, 192u, 19u, 128u, 71u, 1u, 
        14u, 4u, 28u, 0u, 124u, 1u, 232u, 7u, 144u, 30u, 32u, 120u, 
        65u, 208u, 131u, 97u, 5u, 194u, 7u, 68u, 28u, 136u, 113u, 16u, 
        210u, 33u, 100u, 65u, 168u, 134u, 81u, 10u, 162u, 11u, 68u, 38u, 
        136u, 27u, 16u, 102u, 33u, 140u, 66u, 152u, 130u, 177u, 9u, 98u, 
        5u, 196u, 19u, 136u, 71u, 16u, 29u, 32u, 114u, 65u, 196u, 134u, 
        137u, 11u, 18u, 13u, 36u, 50u, 72u, 164u, 146u, 21u, 36u, 74u, 
        72u, 44u, 144u, 153u, 34u, 50u, 64u, 212u, 131u, 41u, 12u, 82u, 
        40u, 164u, 41u, 72u, 146u, 144u, 85u, 33u, 42u, 68u, 84u, 129u, 
        105u, 4u, 210u, 17u, 164u, 6u, 200u, 25u, 144u, 99u, 33u, 134u, 
        66u, 140u, 137u, 25u, 5u, 50u, 18u, 100u, 68u, 200u, 21u, 144u, 
        75u, 33u, 22u, 64u, 92u, 129u, 57u, 4u, 114u, 16u, 228u, 3u, 
        168u, 14u, 80u, 56u, 160u, 225u, 65u, 162u, 134u, 69u, 10u, 138u, 
        37u, 20u, 22u, 40u, 76u, 81u, 24u, 160u, 105u, 65u, 146u, 134u, 
        37u, 10u, 74u, 36u, 148u, 21u, 40u, 74u, 81u, 20u, 160u, 89u, 
        65u, 50u, 132u, 101u, 1u, 170u, 6u, 84u, 24u, 168u, 81u, 81u, 
        34u, 160u, 165u, 66u, 74u, 136u, 149u, 2u, 170u, 9u, 84u, 34u, 
        168u, 11u, 80u, 38u, 160u, 141u, 66u, 26u, 128u, 109u, 1u, 154u, 
        6u, 52u, 24u, 104u, 80u, 208u, 81u, 161u, 35u, 68u, 70u, 129u, 
        77u, 4u, 154u, 17u, 52u, 5u, 104u, 18u, 208u, 69u, 161u, 11u, 
        64u, 46u, 128u, 157u, 2u, 58u, 8u, 116u, 1u, 216u, 7u, 48u, 
        28u, 96u, 112u, 193u, 161u, 133u, 67u, 5u, 134u, 19u, 12u, 13u, 
        24u, 50u, 48u, 196u, 97u, 72u, 196u, 145u, 130u, 163u, 9u, 70u, 
        34u, 140u, 11u, 24u, 38u, 48u, 140u, 96u, 52u, 192u, 201u, 131u, 
        19u, 10u, 38u, 36u, 76u, 20u, 152u, 73u, 49u, 18u, 96u, 84u, 
        193u, 41u, 132u, 83u, 1u, 102u, 4u, 204u, 17u, 152u, 67u, 48u, 
        13u, 96u, 50u, 192u, 197u, 131u, 11u, 10u, 22u, 10u, 44u, 36u, 
        88u, 136u, 176u, 41u, 96u, 146u, 194u, 37u, 128u, 171u, 2u, 86u, 
        8u, 172u, 33u, 88u, 5u, 176u, 19u, 96u, 70u, 193u, 13u, 128u, 
        55u, 0u, 206u, 3u, 28u, 12u, 56u, 48u, 112u, 80u, 225u, 33u, 
        192u, 163u, 130u, 71u, 8u, 142u, 2u, 156u, 9u, 56u, 34u, 112u, 
        132u, 224u, 21u, 192u, 75u, 129u, 23u, 4u, 46u, 0u, 188u, 2u, 
        120u, 8u, 240u, 33u, 224u, 131u, 192u, 15u, 192u, 62u, 128u, 249u, 
        3u, 226u, 15u, 132u, 30u, 136u, 121u, 16u, 234u, 33u, 180u, 66u, 
        232u, 131u, 177u, 14u, 98u, 26u, 196u, 45u, 136u, 55u, 16u, 206u, 
        33u, 92u, 65u, 120u, 132u, 241u, 3u, 210u, 15u, 36u, 60u, 72u, 
        116u, 145u, 201u, 35u, 82u, 69u, 164u, 134u, 201u, 25u, 146u, 43u, 
        36u, 46u, 72u, 156u, 144u, 117u, 33u, 202u, 70u, 148u, 139u, 41u, 
        13u, 82u, 50u, 164u, 85u, 72u, 90u, 145u, 53u, 32u, 218u, 67u, 
        52u, 140u, 105u, 20u, 210u, 21u, 164u, 75u, 72u, 46u, 144u, 157u, 
        34u, 58u, 64u, 236u, 131u, 153u, 14u, 50u, 44u, 100u, 52u, 200u, 
        201u, 145u, 83u, 33u, 102u, 68u, 204u, 131u, 89u, 12u, 178u, 41u, 
        100u, 42u, 200u, 149u, 144u, 91u, 33u, 54u, 68u, 108u, 129u, 185u, 
        6u, 114u, 24u, 228u, 81u, 200u, 83u, 145u, 39u, 32u, 174u, 66u, 
        92u, 136u, 185u, 2u, 242u, 9u, 228u, 35u, 200u, 15u, 80u, 60u, 
        160u, 241u, 67u, 162u, 134u, 197u, 11u, 138u, 39u, 20u, 29u, 40u, 
        114u, 81u, 164u, 162u, 201u, 67u, 82u, 140u, 165u, 40u, 170u, 82u, 
        84u, 161u, 105u, 68u, 210u, 131u, 101u, 12u, 202u, 49u, 148u, 83u, 
        41u, 38u, 80u, 172u, 162u, 89u, 65u, 114u, 132u, 229u, 17u, 202u, 
        7u, 84u, 28u, 168u, 113u, 80u, 210u, 163u, 37u, 69u, 74u, 146u, 
        149u, 11u, 42u, 38u, 84u, 26u, 168u, 101u, 81u, 74u, 164u, 149u, 
        66u, 170u, 137u, 85u, 5u, 170u, 19u, 84u, 70u, 168u, 27u, 80u, 
        102u, 161u, 141u, 69u, 26u, 133u, 53u, 18u, 106u, 10u, 212u, 37u, 
        168u, 139u, 80u, 46u, 160u, 157u, 66u, 58u, 128u, 237u, 3u, 154u, 
        14u, 52u, 52u, 104u, 200u, 209u, 81u, 161u, 99u, 68u, 198u, 131u, 
        77u, 12u, 154u, 41u, 52u, 146u, 104u, 84u, 209u, 41u, 160u, 179u, 
        66u, 102u, 136u, 205u, 3u, 90u, 12u, 180u, 49u, 104u, 162u, 208u, 
        165u, 162u, 75u, 65u, 86u, 132u, 173u, 17u, 90u, 5u, 180u, 19u, 
        104u, 70u, 208u, 27u, 160u, 103u, 65u, 142u, 134u, 29u, 10u, 58u, 
        36u, 116u, 20u, 232u, 73u, 209u, 19u, 160u, 87u, 65u, 46u, 132u, 
        93u, 1u, 122u, 4u, 244u, 17u, 232u, 67u, 208u, 15u, 96u, 60u, 
        192u, 241u, 131u, 195u, 11u, 134u, 14u, 140u, 57u, 24u, 178u, 48u, 
        212u, 98u, 168u, 194u, 209u, 137u, 163u, 6u, 198u, 25u, 140u, 98u, 
        152u, 194u, 177u, 137u, 99u, 5u, 198u, 19u, 140u, 71u, 24u, 29u, 
        48u, 114u, 97u, 196u, 195u, 73u, 140u, 147u, 21u, 38u, 74u, 76u, 
        44u, 152u, 153u, 48u, 106u, 97u, 148u, 197u, 41u, 146u, 83u, 10u, 
        166u, 37u, 76u, 22u, 152u, 77u, 49u, 26u, 96u, 108u, 193u, 153u, 
        134u, 51u, 20u, 102u, 20u, 204u, 73u, 152u, 43u, 48u, 150u, 98u, 
        44u, 192u, 185u, 130u, 115u, 8u, 230u, 3u, 172u, 14u, 88u, 56u, 
        176u, 209u, 98u, 162u, 194u, 197u, 137u, 139u, 6u, 150u, 25u, 44u, 
        82u, 89u, 36u, 176u, 169u, 98u, 82u, 193u, 101u, 132u, 203u, 17u, 
        150u, 6u, 172u, 25u, 88u, 98u, 177u, 69u, 97u, 74u, 196u, 149u, 
        130u, 171u, 9u, 86u, 34u, 172u, 11u, 88u, 38u, 176u, 141u, 96u, 
        54u, 192u, 205u, 131u, 27u, 12u, 54u, 20u, 108u, 72u, 216u, 41u, 
        176u, 147u, 98u, 38u, 192u, 173u, 130u, 91u, 8u, 182u, 2u, 236u, 
        9u, 216u, 35u, 176u, 135u, 96u, 29u, 192u, 115u, 129u, 199u, 7u, 
        14u, 26u, 28u, 44u, 56u, 52u, 112u, 200u, 226u, 145u, 194u, 163u, 
        137u, 71u, 5u, 142u, 19u, 28u, 70u, 56u, 26u, 112u, 100u, 225u, 
        137u, 194u, 147u, 137u, 39u, 5u, 78u, 18u, 156u, 69u, 56u, 22u, 
        112u, 76u, 225u, 25u, 192u, 107u, 129u, 151u, 6u, 46u, 20u, 92u, 
        72u, 184u, 41u, 112u, 146u, 226u, 37u, 192u, 171u, 130u, 87u, 8u, 
        174u, 2u, 220u, 9u, 184u, 35u, 112u, 134u, 224u, 27u, 192u, 103u, 
        129u, 143u, 6u, 30u, 20u, 60u, 20u, 120u, 72u, 241u, 17u, 224u, 
        83u, 193u, 39u, 132u, 79u, 1u, 94u, 4u, 188u, 17u, 120u, 66u, 
        240u, 11u, 224u, 39u, 192u, 143u, 130u, 31u, 0u, 127u, 1u, 250u, 
        7u, 228u, 31u, 136u, 125u, 16u, 246u, 33u, 220u, 67u, 120u, 133u, 
        241u, 7u, 210u, 31u, 36u, 122u, 72u, 236u, 145u, 185u, 34u, 242u, 
        67u, 212u, 143u, 41u, 29u, 82u, 54u, 164u, 93u, 72u, 118u, 145u, 
        205u, 35u, 90u, 69u, 180u, 134u, 233u, 25u, 210u, 43u, 164u, 47u, 
        72u, 158u, 144u, 123u, 33u, 230u, 71u, 76u, 141u, 153u, 23u, 50u, 
        29u, 100u, 114u, 200u, 213u, 145u, 107u, 33u, 182u, 70u, 108u, 138u, 
        217u, 11u, 178u, 39u, 100u, 29u, 200u, 115u, 145u, 199u, 35u, 78u, 
        69u, 156u, 134u, 185u, 25u, 114u, 42u, 228u, 45u, 200u, 155u, 144u, 
        111u, 33u, 158u, 70u, 60u, 138u, 121u, 10u, 242u, 37u, 228u, 23u, 
        200u, 79u, 145u, 31u, 32u, 125u, 65u, 242u, 135u, 197u, 15u, 74u, 
        60u, 148u, 117u, 40u, 218u, 81u, 116u, 164u, 233u, 67u, 178u, 142u, 
        101u, 26u, 202u, 45u, 148u, 155u, 40u, 110u, 81u, 156u, 162u, 185u, 
        73u, 114u, 133u, 229u, 19u, 202u, 15u, 84u, 60u, 168u, 233u, 81u, 
        178u, 162u, 229u, 73u, 202u, 135u, 85u, 28u, 170u, 53u, 84u, 170u, 
        168u, 181u, 82u, 106u, 161u, 181u, 70u, 106u, 148u, 213u, 21u, 170u, 
        75u, 84u, 46u, 168u, 157u, 80u, 118u, 161u, 205u, 70u, 154u, 149u, 
        53u, 22u, 106u, 76u, 212u, 53u, 168u, 203u, 82u, 150u, 162u, 173u, 
        73u, 90u, 133u, 181u, 19u, 106u, 13u, 212u, 51u, 168u, 199u, 81u, 
        78u, 164u, 157u, 66u, 186u, 137u, 117u, 5u, 234u, 19u, 212u, 71u, 
        168u, 30u, 208u, 121u, 161u, 227u, 69u, 198u, 135u, 77u, 28u, 154u, 
        53u, 52u, 170u, 104u, 180u, 210u, 105u, 161u, 179u, 70u, 102u, 148u, 
        205u, 21u, 154u, 75u, 52u, 46u, 104u, 156u, 208u, 117u, 161u, 203u, 
        70u, 150u, 149u, 45u, 22u, 90u, 76u, 180u, 53u, 104u, 202u, 210u, 
        149u, 162u, 171u, 73u, 86u, 133u, 173u, 19u, 90u, 13u, 180u, 51u, 
        104u, 198u, 209u, 77u, 164u, 155u, 66u, 182u, 137u, 109u, 5u, 218u, 
        19u, 180u, 71u, 104u, 29u, 208u, 115u, 161u, 199u, 70u, 142u, 139u, 
        29u, 13u, 58u, 50u, 116u, 84u, 233u, 41u, 208u, 179u, 162u, 103u, 
        65u, 174u, 134u, 93u, 20u, 186u, 73u, 116u, 42u, 232u, 149u, 208u, 
        91u, 161u, 55u, 68u, 110u, 129u, 189u, 6u, 122u, 24u, 244u, 81u, 
        232u, 83u, 209u, 39u, 160u, 175u, 66u, 94u, 136u, 189u, 2u, 250u, 
        9u, 244u, 35u, 232u, 15u, 176u, 62u, 96u, 248u, 195u, 209u, 139u, 
        163u, 14u, 198u, 45u, 140u, 55u, 24u, 174u, 48u, 188u, 98u, 120u, 
        193u, 233u, 135u, 147u, 29u, 38u, 54u, 76u, 92u, 152u, 117u, 49u, 
        202u, 99u, 84u, 202u, 169u, 139u, 83u, 38u, 166u, 27u, 76u, 102u, 
        153u, 77u, 49u, 90u, 100u, 180u, 194u, 233u, 137u, 211u, 7u, 102u, 
        28u, 204u, 105u, 153u, 83u, 49u, 102u, 100u, 204u, 195u, 89u, 140u, 
        179u, 41u, 102u, 42u, 204u, 149u, 152u, 91u, 49u, 54u, 96u, 220u, 
        195u, 57u, 140u, 115u, 20u, 230u, 73u, 204u, 43u, 152u, 151u, 48u, 
        94u, 97u, 60u, 196u, 121u, 129u, 235u, 7u, 150u, 30u, 44u, 58u, 
        88u, 228u, 177u, 169u, 101u, 82u, 197u, 165u, 147u, 75u, 13u, 150u, 
        51u, 44u, 166u, 88u, 172u, 178u, 89u, 97u, 114u, 196u, 229u, 131u, 
        171u, 14u, 86u, 52u, 172u, 169u, 88u, 178u, 178u, 101u, 97u, 170u, 
        198u, 85u, 148u, 171u, 21u, 86u, 74u, 172u, 45u, 88u, 154u, 176u, 
        109u, 97u, 154u, 198u, 53u, 138u, 107u, 36u, 214u, 21u, 172u, 75u, 
        88u, 46u, 176u, 157u, 98u, 58u, 192u, 237u, 131u, 155u, 14u, 54u, 
        52u, 108u, 88u, 216u, 105u, 177u, 147u, 98u, 166u, 201u, 77u, 133u, 
        155u, 19u, 54u, 13u, 108u, 50u, 216u, 165u, 178u, 75u, 97u, 86u, 
        196u, 173u, 130u, 219u, 9u, 182u, 35u, 108u, 13u, 216u, 51u, 176u, 
        199u, 98u, 142u, 194u, 157u, 137u, 59u, 5u, 118u, 18u, 236u, 69u, 
        216u, 23u, 176u, 79u, 97u, 30u, 192u, 123u, 129u, 231u, 7u, 142u, 
        29u, 28u, 106u, 56u, 180u, 112u, 216u, 227u, 49u, 197u, 99u, 133u, 
        199u, 19u, 142u, 14u, 156u, 57u, 56u, 210u, 113u, 100u, 228u, 201u, 
        195u, 83u, 140u, 167u, 41u, 78u, 42u, 156u, 149u, 56u, 90u, 113u, 
        52u, 224u, 217u, 195u, 51u, 140u, 103u, 20u, 206u, 73u, 156u, 43u, 
        56u, 150u, 112u, 92u, 225u, 57u, 196u, 115u, 129u, 215u, 7u, 46u, 
        28u, 92u, 88u, 184u, 105u, 113u, 146u, 226u, 165u, 201u, 75u, 133u, 
        151u, 19u, 46u, 13u, 92u, 50u, 184u, 165u, 114u, 74u, 225u, 85u, 
        196u, 171u, 130u, 215u, 9u, 174u, 35u, 92u, 13u, 184u, 51u, 112u, 
        198u, 226u, 141u, 194u, 155u, 137u, 55u, 5u, 110u, 18u, 220u, 69u, 
        184u, 23u, 112u, 78u, 225u, 29u, 192u, 119u, 129u, 207u, 7u, 30u, 
        28u, 60u, 52u, 120u, 200u, 241u, 81u, 225u, 99u, 196u, 199u, 131u, 
        79u, 12u, 158u, 41u, 60u, 146u, 120u, 84u, 241u, 41u, 224u, 179u, 
        194u, 103u, 136u, 207u, 3u, 94u, 12u, 188u, 49u, 120u, 162u, 240u, 
        165u, 226u, 75u, 193u, 87u, 132u, 175u, 17u, 94u, 5u, 188u, 19u, 
        120u, 70u, 240u, 27u, 224u, 103u, 193u, 143u, 134u, 31u, 10u, 62u, 
        36u, 124u, 20u, 248u, 73u, 241u, 19u, 224u, 87u, 193u, 47u, 132u, 
        95u, 1u, 126u, 4u, 252u, 17u, 248u, 67u, 240u, 15u, 240u, 63u, 
        160u, 254u, 67u, 248u, 135u, 233u, 31u, 146u, 62u, 164u, 123u, 72u, 
        238u, 145u, 189u, 34u, 250u, 67u, 236u, 143u, 153u, 30u, 178u, 59u, 
        100u, 110u, 200u, 189u, 144u, 247u, 35u, 206u, 71u, 92u, 141u, 185u, 
        23u, 114u, 29u, 228u, 115u, 200u, 215u, 145u, 111u, 33u, 190u, 70u, 
        124u, 138u, 249u, 11u, 242u, 39u, 228u, 31u, 168u, 126u, 81u, 244u, 
        163u, 217u, 71u, 114u, 141u, 229u, 23u, 202u, 79u, 148u, 62u, 168u, 
        249u, 81u, 234u, 167u, 85u, 77u, 170u, 151u, 85u, 29u, 170u, 107u, 
        84u, 182u, 168u, 221u, 83u, 58u, 165u, 117u, 69u, 234u, 147u, 213u, 
        15u, 106u, 60u, 212u, 185u, 168u, 235u, 83u, 86u, 165u, 173u, 70u, 
        218u, 153u, 181u, 43u, 106u, 46u, 212u, 157u, 168u, 119u, 81u, 206u, 
        166u, 157u, 75u, 58u, 141u, 117u, 42u, 234u, 45u, 212u, 155u, 168u, 
        111u, 81u, 158u, 165u, 61u, 69u, 122u, 146u, 245u, 11u, 234u, 39u, 
        212u, 31u, 104u, 124u, 209u, 233u, 165u, 211u, 71u, 102u, 150u, 205u, 
        27u, 154u, 103u, 52u, 174u, 104u, 188u, 210u, 121u, 161u, 235u, 71u, 
        150u, 142u, 173u, 53u, 90u, 90u, 180u, 109u, 105u, 154u, 210u, 181u, 
        162u, 235u, 73u, 214u, 135u, 109u, 28u, 218u, 105u, 180u, 179u, 104u, 
        214u, 210u, 173u, 162u, 219u, 73u, 182u, 134u, 237u, 25u, 218u, 83u, 
        180u, 87u, 105u, 46u, 208u, 189u, 162u, 123u, 65u, 238u, 135u, 157u, 
        29u, 58u, 106u, 116u, 180u, 232u, 217u, 211u, 51u, 165u, 103u, 69u, 
        206u, 147u, 157u, 14u, 186u, 57u, 116u, 178u, 232u, 213u, 210u, 171u, 
        162u, 215u, 73u, 174u, 134u, 221u, 25u, 186u, 83u, 116u, 86u, 233u, 
        45u, 208u, 187u, 162u, 119u, 65u, 222u, 135u, 61u, 28u, 122u, 52u, 
        244u, 169u, 232u, 179u, 210u, 103u, 161u, 175u, 70u, 94u, 148u, 189u, 
        21u, 122u, 74u, 244u, 45u, 232u, 155u, 208u, 111u, 161u, 159u, 70u, 
        62u, 138u, 125u, 36u, 250u, 21u, 244u, 75u, 232u, 47u, 208u, 159u, 
        162u, 63u, 64u, 253u, 131u, 243u, 15u, 198u, 47u, 140u, 62u, 152u, 
        249u, 49u, 234u, 101u, 212u, 199u, 105u, 150u, 211u, 27u, 166u, 87u, 
        76u, 94u, 153u, 61u, 48u, 246u, 99u, 204u, 203u, 153u, 142u, 179u, 
        45u, 102u, 54u, 204u, 173u, 152u, 187u, 50u, 118u, 97u, 220u, 199u, 
        57u, 150u, 115u, 26u, 230u, 85u, 204u, 91u, 153u, 55u, 48u, 222u, 
        99u, 60u, 202u, 121u, 138u, 243u, 37u, 230u, 23u, 204u, 79u, 152u, 
        62u, 176u, 249u, 99u, 210u, 199u, 101u, 141u, 203u, 43u, 150u, 47u, 
        44u, 158u, 88u, 122u, 177u, 229u, 99u, 170u, 205u, 85u, 170u, 171u, 
        45u, 86u, 54u, 172u, 205u, 89u, 90u, 177u, 117u, 100u, 234u, 195u, 
        181u, 142u, 107u, 52u, 214u, 89u, 172u, 107u, 89u, 86u, 177u, 109u, 
        100u, 218u, 195u, 117u, 140u, 235u, 41u, 214u, 43u, 172u, 151u, 88u, 
        94u, 177u, 61u, 96u, 246u, 195u, 205u, 142u, 155u, 53u, 54u, 90u, 
        108u, 108u, 217u, 153u, 178u, 179u, 98u, 230u, 201u, 205u, 135u, 91u, 
        28u, 182u, 89u, 108u, 106u, 217u, 85u, 177u, 107u, 100u, 214u, 195u, 
        109u, 140u, 219u, 41u, 182u, 43u, 108u, 150u, 216u, 93u, 177u, 59u, 
        96u, 238u, 195u, 157u, 142u, 59u, 26u, 118u, 84u, 236u, 89u, 217u, 
        51u, 176u, 215u, 99u, 46u, 202u, 93u, 138u, 187u, 37u, 118u, 22u, 
        236u, 77u, 216u, 55u, 176u, 207u, 99u, 30u, 197u, 61u, 146u, 123u, 
        10u, 246u, 37u, 236u, 23u, 216u, 79u, 177u, 31u, 96u, 125u, 193u, 
        243u, 135u, 199u, 27u, 142u, 47u, 28u, 61u, 56u, 242u, 113u, 212u, 
        230u, 169u, 203u, 83u, 141u, 167u, 51u, 78u, 86u, 156u, 93u, 57u, 
        58u, 112u, 236u, 227u, 153u, 203u, 51u, 141u, 103u, 42u, 206u, 45u, 
        156u, 155u, 56u, 110u, 113u, 156u, 229u, 57u, 197u, 115u, 146u, 231u, 
        11u, 206u, 39u, 156u, 30u, 184u, 121u, 113u, 210u, 229u, 165u, 198u, 
        203u, 149u, 151u, 23u, 46u, 78u, 92u, 58u, 184u, 229u, 113u, 170u, 
        229u, 85u, 197u, 171u, 147u, 87u, 13u, 174u, 51u, 92u, 166u, 184u, 
        173u, 114u, 90u, 225u, 117u, 196u, 235u, 131u, 183u, 14u, 110u, 52u, 
        220u, 169u, 184u, 179u, 114u, 102u, 225u, 173u, 198u, 91u, 148u, 183u, 
        21u, 110u, 74u, 220u, 45u, 184u, 155u, 112u, 110u, 225u, 157u, 198u, 
        59u, 138u, 119u, 36u, 238u, 21u, 220u, 75u, 184u, 47u, 112u, 158u, 
        226u, 61u, 192u, 247u, 131u, 207u, 15u, 30u, 58u, 60u, 108u, 120u, 
        184u, 240u, 233u, 227u, 147u, 198u, 167u, 149u, 79u, 22u, 158u, 77u, 
        60u, 54u, 120u, 204u, 242u, 153u, 226u, 179u, 201u, 103u, 133u, 207u, 
        19u, 158u, 14u, 188u, 57u, 120u, 210u, 242u, 165u, 226u, 203u, 201u, 
        151u, 134u, 175u, 25u, 94u, 82u, 188u, 85u, 121u, 42u, 240u, 181u, 
        226u, 107u, 193u, 183u, 134u, 111u, 24u, 222u, 41u, 188u, 147u, 120u, 
        86u, 241u, 45u, 224u, 187u, 194u, 119u, 136u, 239u, 3u, 190u, 14u, 
        124u, 56u, 248u, 209u, 241u, 99u, 225u, 167u, 198u, 79u, 138u, 159u, 
        37u, 62u, 22u, 124u, 76u, 248u, 53u, 240u, 203u, 226u, 151u, 201u, 
        47u, 133u, 95u, 18u, 190u, 11u, 124u, 38u, 248u, 141u, 240u, 55u, 
        224u, 207u, 195u, 31u, 138u, 63u, 10u, 126u, 36u, 252u, 21u, 248u, 
        75u, 241u, 23u, 224u, 95u, 193u, 63u, 132u, 127u, 1u, 255u, 7u, 
        250u, 31u, 228u, 127u, 72u, 253u, 145u, 247u, 35u, 222u, 71u, 124u, 
        141u, 249u, 23u, 242u, 31u, 212u, 127u, 40u, 253u, 83u, 234u, 167u, 
        181u, 78u, 234u, 155u, 213u, 47u, 170u, 62u, 212u, 245u, 169u, 219u, 
        83u, 118u, 165u, 237u, 71u, 186u, 157u, 117u, 54u, 234u, 93u, 212u, 
        119u, 169u, 207u, 83u, 94u, 165u, 189u, 70u, 250u, 153u, 245u, 43u, 
        234u, 47u, 212u, 159u, 168u, 126u, 209u, 249u, 165u, 243u, 71u, 214u, 
        158u, 173u, 59u, 90u, 110u, 180u, 189u, 104u, 246u, 211u, 173u, 166u, 
        219u, 75u, 182u, 142u, 237u, 57u, 218u, 107u, 180u, 183u, 104u, 222u, 
        211u, 61u, 165u, 123u, 69u, 246u, 147u, 237u, 15u, 186u, 62u, 116u, 
        220u, 233u, 121u, 209u, 235u, 167u, 87u, 77u, 174u, 151u, 93u, 29u, 
        186u, 107u, 116u, 182u, 232u, 221u, 211u, 59u, 165u, 119u, 69u, 238u, 
        147u, 221u, 15u, 122u, 60u, 244u, 233u, 233u, 179u, 210u, 231u, 163u, 
        175u, 77u, 94u, 150u, 189u, 27u, 122u, 102u, 244u, 173u, 232u, 187u, 
        210u, 119u, 161u, 223u, 71u, 62u, 154u, 125u, 44u, 250u, 53u, 244u, 
        171u, 232u, 183u, 210u, 111u, 161u, 191u, 70u, 126u, 148u, 253u, 21u, 
        250u, 75u, 244u, 47u, 232u, 159u, 208u, 127u, 97u, 252u, 199u, 233u, 
        151u, 211u, 31u, 102u, 94u, 204u, 123u, 153u, 119u, 49u, 222u, 101u, 
        188u, 198u, 249u, 149u, 243u, 23u, 230u, 79u, 204u, 63u, 88u, 252u, 
        177u, 245u, 103u, 170u, 206u, 213u, 155u, 171u, 47u, 86u, 61u, 172u, 
        235u, 90u, 205u, 181u, 171u, 107u, 46u, 214u, 59u, 172u, 231u, 89u, 
        174u, 181u, 93u, 101u, 186u, 198u, 245u, 153u, 235u, 43u, 214u, 47u, 
        172u, 159u, 88u, 125u, 177u, 243u, 101u, 230u, 199u, 173u, 157u, 91u, 
        54u, 182u, 173u, 108u, 186u, 216u, 237u, 179u, 91u, 106u, 182u, 203u, 
        109u, 141u, 219u, 51u, 182u, 87u, 108u, 94u, 217u, 61u, 176u, 247u, 
        99u, 206u, 206u, 157u, 155u, 59u, 46u, 118u, 58u, 236u, 213u, 218u, 
        171u, 178u, 215u, 99u, 110u, 204u, 221u, 149u, 187u, 23u, 118u, 78u, 
        236u, 59u, 216u, 231u, 179u, 79u, 101u, 158u, 198u, 189u, 149u, 123u, 
        22u, 246u, 77u, 236u, 55u, 216u, 207u, 178u, 159u, 98u, 190u, 201u, 
        125u, 133u, 251u, 19u, 246u, 15u, 220u, 63u, 56u, 250u, 115u, 116u, 
        229u, 233u, 199u, 179u, 155u, 103u, 46u, 206u, 59u, 156u, 230u, 185u, 
        203u, 115u, 141u, 231u, 51u, 206u, 87u, 156u, 95u, 57u, 62u, 112u, 
        250u, 227u, 229u, 199u, 171u, 157u, 87u, 54u, 174u, 173u, 92u, 186u, 
        184u, 237u, 115u, 90u, 234u, 181u, 203u, 107u, 141u, 215u, 51u, 174u, 
        87u, 92u, 94u, 185u, 61u, 112u, 246u, 227u, 205u, 205u, 155u, 151u, 
        55u, 29u, 110u, 106u, 221u, 85u, 185u, 107u, 113u, 182u, 230u, 109u, 
        202u, 219u, 139u, 183u, 39u, 110u, 29u, 220u, 115u, 185u, 167u, 114u, 
        206u, 227u, 93u, 202u, 187u, 139u, 119u, 38u, 238u, 27u, 220u, 103u, 
        185u, 79u, 113u, 94u, 228u, 189u, 194u, 251u, 137u, 247u, 7u, 222u, 
        31u, 60u, 122u, 121u, 212u, 243u, 105u, 229u, 211u, 199u, 103u, 154u, 
        207u, 45u, 158u, 55u, 60u, 206u, 121u, 92u, 241u, 121u, 228u, 243u, 
        195u, 215u, 143u, 47u, 46u, 94u, 58u, 188u, 213u, 122u, 170u, 242u, 
        213u, 227u, 107u, 204u, 215u, 149u, 175u, 23u, 94u, 78u, 188u, 59u, 
        120u, 230u, 243u, 77u, 229u, 155u, 198u, 183u, 149u, 111u, 22u, 222u, 
        77u, 188u, 55u, 120u, 206u, 242u, 157u, 226u, 187u, 201u, 119u, 133u, 
        239u, 19u, 222u, 15u, 124u, 60u, 248u, 241u, 241u, 211u, 230u, 167u, 
        203u, 79u, 141u, 159u, 51u, 62u, 86u, 124u, 92u, 249u, 57u, 240u, 
        235u, 227u, 151u, 203u, 47u, 141u, 95u, 42u, 190u, 45u, 124u, 154u, 
        248u, 109u, 241u, 155u, 229u, 55u, 197u, 111u, 146u, 223u, 11u, 190u, 
        39u, 124u, 29u, 248u, 115u, 241u, 199u, 227u, 79u, 202u, 159u, 139u, 
        63u, 38u, 126u, 26u, 252u, 101u, 249u, 75u, 241u, 87u, 228u, 175u, 
        194u, 223u, 137u, 191u, 6u, 254u, 25u, 252u, 99u, 248u, 167u, 242u, 
        79u, 225u, 95u, 196u, 191u, 130u, 255u, 9u, 254u, 35u, 252u, 15u, 
        252u, 63u, 232u, 255u, 145u, 254u, 167u, 245u, 79u, 218u, 159u, 117u, 
        61u, 234u, 119u, 212u, 223u, 169u, 127u, 81u, 253u, 167u, 235u, 79u, 
        182u, 158u, 237u, 59u, 218u, 111u, 180u, 191u, 104u, 253u, 211u, 235u, 
        167u, 183u, 78u, 238u, 155u, 221u, 47u, 186u, 62u, 244u, 245u, 233u, 
        219u, 211u, 119u, 165u, 239u, 71u, 190u, 158u, 125u, 58u, 250u, 109u, 
        244u, 187u, 232u, 239u, 211u, 159u, 166u, 191u, 75u, 126u, 141u, 253u, 
        51u, 250u, 87u, 244u, 95u, 233u, 63u, 208u, 255u, 99u, 252u, 203u, 
        249u, 143u, 235u, 63u, 86u, 125u, 172u, 247u, 89u, 222u, 179u, 125u, 
        106u, 250u, 203u, 245u, 143u, 219u, 62u, 182u, 123u, 109u, 174u, 219u, 
        59u, 182u, 183u, 108u, 222u, 218u, 189u, 178u, 251u, 99u, 238u, 207u, 
        93u, 174u, 187u, 59u, 118u, 182u, 236u, 221u, 218u, 187u, 178u, 247u, 
        99u, 222u, 207u, 61u, 157u, 123u, 90u, 246u, 109u, 237u, 91u, 217u, 
        119u, 177u, 223u, 103u, 62u, 205u, 125u, 170u, 251u, 45u, 246u, 55u, 
        236u, 207u, 217u, 95u, 177u, 127u, 100u, 254u, 195u, 251u, 143u, 231u, 
        55u, 206u, 95u, 156u, 126u, 185u, 245u, 115u, 218u, 231u, 117u, 214u, 
        235u, 155u, 215u, 87u, 174u, 95u, 92u, 125u, 185u, 235u, 115u, 182u, 
        235u, 109u, 205u, 219u, 171u, 183u, 47u, 110u, 61u, 220u, 235u, 186u, 
        215u, 115u, 110u, 234u, 221u, 203u, 187u, 142u, 247u, 57u, 238u, 107u, 
        221u, 87u, 185u, 111u, 113u, 190u, 230u, 125u, 202u, 251u, 139u, 247u, 
        39u, 238u, 31u, 188u, 126u, 121u, 220u, 243u, 121u, 229u, 243u, 199u, 
        215u, 158u, 175u, 59u, 94u, 182u, 188u, 221u, 122u, 186u, 242u, 245u, 
        227u, 219u, 206u, 183u, 173u, 111u, 54u, 222u, 173u, 188u, 187u, 120u, 
        238u, 243u, 157u, 230u, 187u, 213u, 119u, 150u, 239u, 27u, 222u, 103u, 
        188u, 175u, 120u, 190u, 242u, 125u, 225u, 247u, 199u, 207u, 158u, 159u, 
        59u, 62u, 110u, 124u, 188u, 248u, 245u, 243u, 171u, 230u, 215u, 213u, 
        175u, 151u, 95u, 29u, 190u, 107u, 125u, 86u, 249u, 109u, 241u, 187u, 
        230u, 119u, 202u, 239u, 139u, 223u, 39u, 190u, 30u, 252u, 121u, 249u, 
        211u, 243u, 103u, 229u, 207u, 199u, 95u, 154u, 191u, 85u, 126u, 90u, 
        252u, 109u, 249u, 155u, 242u, 183u, 226u, 239u, 201u, 223u, 135u, 127u, 
        28u, 254u, 105u, 252u, 179u, 248u, 215u, 242u, 175u, 226u, 223u, 201u, 
        191u, 134u, 255u, 25u, 254u, 83u, 252u, 87u, 249u, 47u, 240u, 191u, 
        226u, 127u, 193u, 255u, 199u, 254u, 159u, 245u, 63u, 218u, 127u, 116u, 
        253u, 233u, 247u, 211u, 223u, 167u, 127u, 77u, 254u, 151u, 253u, 31u, 
        246u, 127u, 172u, 254u, 218u, 253u, 179u, 247u, 107u, 238u, 207u, 189u, 
        175u, 123u, 61u, 246u, 187u, 236u, 239u, 218u, 223u, 179u, 127u, 106u, 
        254u, 203u, 253u, 143u, 247u, 63u, 174u, 126u, 221u, 125u, 185u, 247u, 
        118u, 238u, 235u, 221u, 207u, 123u, 182u, 247u, 93u, 238u, 119u, 221u, 
        111u, 185u, 191u, 117u, 126u, 229u, 253u, 199u, 247u, 159u, 175u, 62u, 
        222u, 221u, 189u, 123u, 121u, 238u, 246u, 221u, 235u, 187u, 206u, 247u, 
        173u, 239u, 55u, 222u, 175u, 188u, 191u, 120u, 253u, 243u, 235u, 235u, 
        215u, 207u, 111u, 182u, 223u, 93u, 190u, 119u, 125u, 110u, 249u, 189u, 
        245u, 123u, 229u, 247u, 199u, 223u, 159u, 63u, 61u, 126u, 186u, 252u, 
        237u, 250u, 219u, 243u, 119u, 234u, 239u, 203u, 223u, 143u, 127u, 60u, 
        254u, 117u, 253u, 107u, 249u, 183u, 245u, 111u, 229u, 223u, 199u, 127u, 
        156u, 255u, 53u, 254u, 171u, 252u, 183u, 248u, 223u, 243u, 63u, 229u, 
        127u, 197u, 255u, 147u, 255u, 15u, 255u, 63u, 250u, 127u, 237u, 127u, 
        217u, 255u, 118u, 254u, 235u, 253u, 207u, 247u, 189u, 223u, 123u, 126u, 
        245u, 253u, 231u, 247u, 221u, 239u, 183u, 223u, 95u, 190u, 126u, 253u, 
        221u, 251u, 123u, 245u, 247u, 231u, 223u, 219u, 191u, 175u, 127u, 61u, 
        254u, 219u, 253u, 119u, 249u, 223u, 245u, 191u, 230u, 255u, 213u, 255u, 
        151u, 255u, 31u, 255u, 126u, 254u, 251u, 253u, 239u, 251u, 191u, 246u, 
        255u, 235u, 255u, 207u, 255u, 223u, 255u, 192u};
    static const constexpr std::array<uint16_t, 16> offs = {0, 0, 15, 121, 577, 1943, 4947, 9953, 16389, 22825, 27831, 30835, 32201, 32657, 32763, 32779};
   public:
    static constexpr uint16_t decode(uint16_t C, uint16_t off) {
        const constexpr uint16_t mask = (uint16_t(1) << 15) - 1;
        off += offs[C];
        uint32_t idx = off / 8;
        off %= 8;
        uint64_t w = be64toh(reinterpret_cast<const uint64_t*>(data.data() + idx)[0]);
        w = (w >> (49 - off)) & mask;
        w ^= (C - __builtin_popcountll(w)) & uint64_t(1);
        return w;
    }

};
std::unique_ptr<uint16_t[]>  encode_array() {
    auto bin = binoms<15>();
    auto ret = std::make_unique<uint16_t[]>(32768);
    for (uint16_t C = 0; C <= 15; ++C) {
        for (uint16_t off = 0; off < bin[C]; ++off) {
            ret[wdbs::decode(C, off)] = off;
        }
    }
    return ret;
}

const constexpr std::array<uint8_t, 16> f_widths() {
    std::array<uint8_t, 16> ret;
    auto bins = binoms<15>();
    for (uint16_t i = 0; i <= 15; ++i) {
        ret[i] = 64 - __builtin_clzll(bins[i] - 1);
    }
    return ret;
}

} // namespace internal

template <uint16_t k = 32>
class h0_wdb {
   private:
    static const constexpr internal::wdbs coder = internal::wdbs();
    static const constexpr auto widths = internal::f_widths();
    static const constexpr uint16_t k_width = 64 - __builtin_clzll(15);
    sdsl::int_vector<> meta_point;
    sdsl::int_vector<> meta_rank;
    sdsl::int_vector<> data_typ;
    sdsl::bit_vector data_val;
    uint64_t size_;
    uint64_t sum_;

   public:
    h0_wdb(const sdsl::bit_vector& bv) : sum_(0) {
        auto enc_arr = internal::encode_array();

        size_ = bv.size();
        uint64_t blocks = (size_ + 15 - 1) / 15;
        uint64_t block = 0;
        uint64_t offset = 0;
        while (blocks--) {
            uint64_t elem = bv.get_int(15 * block++, 15);
            uint16_t p = __builtin_popcountll(elem);
            sum_ += p;
            offset += widths[p];
        }

        uint64_t v_siz = (size_ + k * 15 - 1) / (k * 15);
        data_typ = sdsl::int_vector<>((size_ + 15 - 1) / 15, 0, k_width);
        data_val = sdsl::bit_vector(offset);
        meta_point = sdsl::int_vector<>(v_siz, 0, 64 - __builtin_clzll(size_));
        meta_rank = sdsl::int_vector<>(v_siz, 0, 64 - __builtin_clzll(sum_));

        block = 0;
        sum_ = 0;
        offset = 0;
        blocks = (size_ + 15 - 1) / 15;
        uint64_t s_block = 0;
        while (blocks--) {
            if (block % k == 0) {
                assert(meta_point.size() > s_block);
                meta_point[s_block] = offset;
                assert(meta_rank.size() > s_block);
                meta_rank[s_block++] = sum_;
            }
            uint64_t elem = bv.get_int(15 * block, 15);
            uint16_t pop = __builtin_popcountll(elem);
            uint64_t v = enc_arr[elem];
            sum_ += pop;
            assert(data_typ.size() > block);
            data_typ[block++] = pop;
            data_val.set_int(offset, v, widths[pop]);
            offset += widths[pop];
        }
    }

    bool access(uint64_t i) const {
        uint64_t block = i / 15;
        auto bk = data_typ[block];
        if (bk == 0 || bk == 15) {
            return bk != 0;
        }
        uint64_t s_block = block / k;
        uint16_t b_offset = block % k;
        i %= 15;
        uint64_t offset = meta_point[s_block];
        for (uint64_t j = 0; j < k; ++j) {
            auto bk = data_typ[s_block * k + j];
            if (b_offset == j) {
                break;
            }
            offset += widths[bk];
        }
        auto f = data_val.get_int(offset, widths[bk]);
        return (coder.decode(bk, f) >> i) & 1;
    }

    uint64_t rank(uint64_t i) const {
        if (i >= size_) [[unlikely]] {
            return sum_;
        }
        uint64_t block = i / 15;
        uint64_t s_block = block / k;
        uint16_t b_offset = block % k;
        i %= 15;
        uint64_t offset = meta_point[s_block];
        uint64_t prefix_rank = meta_rank[s_block];
        for (uint64_t j = 0; j < k; ++j) {
            if (b_offset == j) {
                break;
            }
            auto bk = data_typ[s_block * k + j];
            prefix_rank += bk;
            offset += widths[bk];
        }
        auto bk = data_typ[block];
        auto f = data_val.get_int(offset, widths[bk]);
        uint64_t v = coder.decode(bk, f);
        v &= (uint64_t(1) << i) - 1;
        return prefix_rank + __builtin_popcountll(v);
    }

    uint64_t select(uint64_t s) const {
        uint64_t a = 0;
        uint64_t b = meta_point.size() - 1;
        while (a < b) {
            uint64_t m = (a + b + 1) / 2;
            if (meta_rank[m] >= s) {
                b = m - 1;
            } else {
                a = m;
            }
        }
        uint64_t offset = meta_point[a];
        s -= meta_rank[a];
        uint64_t res = k * a * 15;
        uint16_t bk = 0;
        uint64_t f = 0;
        uint64_t block = a * k;
        for (uint16_t i = 0; i < k; ++i) {
            bk = data_typ[block++];
            if (bk >= s) {
                f = data_val.get_int(offset, widths[bk]);
                break;
            }
            offset += widths[bk];
            res += 15;
            s -= bk;
        }
        uint64_t v = coder.decode(bk, f);
        uint64_t pos = uint64_t(1) << (s - 1);
        return res + __builtin_ctzll(_pdep_u64(pos, v));
    }

    uint64_t size() const { return size_; }

    uint64_t bytes_size() const {
        return sizeof(h0_wdb) + sdsl::size_in_bytes(meta_point) + sdsl::size_in_bytes(meta_rank) + 
                               sdsl::size_in_bytes(data_typ) + sdsl::size_in_bytes(data_val);
    }
};

}  // namespace h0

